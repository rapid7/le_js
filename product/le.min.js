/*
 Copyright 2013 Logentries.
 Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
*/
'use strict';var LE=function(d){function l(a){var b=(Math.random()+Math.PI).toString(36).substring(2,10),t=a.trace,f=a.page_info,e=a.token,k=a.print,q;q="undefined"===typeof XDomainRequest?a.ssl:"https:"===d.location.protocol?!0:!1;var g=[],h=!1,r=!1;if(a.catchall){var s=d.onerror;d.onerror=function(a,b,c){m({error:a,line:c,location:b}).level("ERROR").send();return s?s(a,b,c):!1}}var l=function(){var a=d.navigator||{doNotTrack:void 0},b=d.screen||{};return{url:(d.location||{}).pathname,referrer:document.referrer,
screen:{width:b.width,height:b.height},window:{width:d.innerWidth,height:d.innerHeight},browser:{name:a.appName,version:a.appVersion,cookie_enabled:a.cookieEnabled,do_not_track:a.doNotTrack},platform:a.platform}},p=function(){var a=null,a=Array.prototype.slice.call(arguments);if(0===a.length)throw Error("No arguments!");return a=1===a.length?a[0]:a},m=function(a){var d=p.apply(this,arguments),c={event:d};"never"===f||r&&"per-entry"!==f||(r=!0,"undefined"===typeof d.screen&&"undefined"===typeof d.browser&&
m(l()).level("PAGE").send());t&&(c.trace=b);return{level:function(a){if(k&&"undefined"!==typeof console&&"PAGE"!==a)try{console[a.toLowerCase()].call(console,c)}catch(b){console.log(c)}c.level=a;return{send:function(){var a=[],b=JSON.stringify(c,function(b,c){if("undefined"===typeof c)return"undefined";if("object"===typeof c&&null!==c){var d;a:{for(d=0;d<a.length;d++)if(c===a[d])break a;d=-1}if(-1!==d)return"\x3c?\x3e";a.push(c)}return c});h?g.push(b):n(e,b)}}}}};this.log=m;var n=function(a,b){h=
!0;var c;c="undefined"!==typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest;c.constructor===XMLHttpRequest?c.onreadystatechange=function(){4===c.readyState&&(400<=c.status?(console.error("Couldn't submit events."),410===c.status&&console.warn("This version of le_js is no longer supported!")):(301===c.status&&console.warn("This version of le_js is deprecated! Consider upgrading."),0<g.length?n(a,g.shift()):h=!1))}:c.onload=function(){0<g.length?n(a,g.shift()):h=!1};c.open("POST",(q?"https://":
"http://")+"js.logentries.com/v1/logs/"+e,!0);c.constructor===XMLHttpRequest&&(c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Content-type","text/json"));c.send(b)}}function p(a){var b,d={ssl:!0,catchall:!1,trace:!0,page_info:"never",print:!1};if("object"===typeof a)for(var f in a)d[f]=a[f];else throw Error("Invalid parameters for createLogStream()");if(void 0===d.token)throw Error("Token not present.");b=new l(d);var e=function(a){if(b)return b.log.apply(this,arguments);
throw Error("You must call LE.init(...) first.");};return{log:function(){e.apply(this,arguments).level("LOG").send()},warn:function(){e.apply(this,arguments).level("WARN").send()},error:function(){e.apply(this,arguments).level("ERROR").send()},info:function(){e.apply(this,arguments).level("INFO").send()}}}var b={},k=function(a){if("string"!==typeof a.name)throw Error("Name not present.");if(b.hasOwnProperty(a.name))throw Error("Alrready exist this name for a logStream");b[a.name]=new p(a);return!0};
return{init:function(a){var b={name:"default"};if("object"===typeof a)for(var d in a)b[d]=a[d];else if("string"===typeof a)b.token=a;else throw Error("Invalid parameters for init()");return k(b)},createLogStream:k,to:function(a){if(!b.hasOwnProperty(a))throw Error("Invalid name for logStream");return b[a]},log:function(){for(var a in b)b[a].log.apply(this,arguments)},warn:function(){for(var a in b)b[a].warn.apply(this,arguments)},error:function(){for(var a in b)b[a].error.apply(this,arguments)},info:function(){for(var a in b)b[a].info.apply(this,
arguments)}}}(this);